---
layout: default
title: jsml
description: A concise specification for dynamic DOM construction using javascript objects.
---
<h1>jsml</h1>
<p>Jsml (<em>javascript markup language</em>) is a concise way of generating pieces of the DOM dynamically. If you've ever tried to build up a chunk of the DOM using the browser's DOM API, you know that the resulting code is repetitive and hard to read:</p>
<pre class="prettyprint">var div = document.createElement("div");
div.appendChild(document.createTextNode("Don't click "));
var a = document.createElement("a");
a.href = "http://kganser.com";
a.onclick = function(e) { e.preventDefault(); alert("You Clicked!"); };
a.appendChild(document.createTextNode("here"));
div.appendChild(a);
document.body.appendChild(div);</pre>
<p>The same structure can be generated using jsml as follows:</p>
<pre class="prettyprint">$(document.body).jsml({div: [
  "Don't click ",
  {a: [{
    href: "http://kganser.com",
    onclick: function(e) { e.preventDefault(); alert("You Clicked!"); }
  }, ["here"]]}
]});</pre>
<h2>Production rules</h2>
<pre><strong>element</strong> = {<em>tagname</em>: <strong>attributes</strong>}
        | {<em>tagname</em>: <strong>primitive</strong>}
        | {<em>tagname</em>: [<strong>child</strong>, ...]}
        | {<em>tagname</em>: [<strong>attributes</strong>, [<strong>child</strong>, ...]]}
<strong>attributes</strong> = {<em>name</em>: <em>value</em>, ...}
<strong>child</strong> = <strong>element</strong> | <strong>primitive</strong>
<strong>primitive</strong> = <em>null</em> | <em>string</em> | <em>number</em> | <em>boolean</em> | <em>function</em></pre>
<p>An element is specified as an object with a single key and value. The key is the element's <em>tagname</em>, and its value is either an object with its attributes, its content, or an array of the two.</p>
<h3>Examples</h3>
<table>
  <thead>
    <tr>
      <th>jsml</th>
      <th>html</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>{div: null}</code></td>
      <td><code>&lt;div>&lt;/div></code></td>
    </tr>
    <tr>
      <td><code>{div: "hello"}</code></td>
      <td><code>&lt;div>hello&lt;/div></code></td>
    </tr>
    <tr>
      <td><code>{div: {className: "hello"}}</code></td>
      <td><code>&lt;div class="hello">&lt;/div></code></td>
    </tr>
    <tr>
      <td><code>{div: [{className: "hello"}, ["world"]]}</code></td>
      <td><code>&lt;div class="hello">world&lt;/div></code></td>
    </tr>
    <tr>
      <td><code>{div: [{className: "hello"}, [{span: "world"}]]}</code></td>
      <td><code>&lt;div class="hello">&lt;span>world&lt;/span>&lt;/div></code></td>
    </tr>
    <tr>
      <td><code>{div: function(elem) {<br/>&nbsp;&nbsp;elem.innerHTML = "hello, world";<br>}}</code></td>
      <td><code>&lt;div>hello, world&lt;/div></code></td>
    </tr>
  </tbody>
</table>
<h2>Leveraging Javascript</h2>
<p>The last example uses a function to populate the parent element, which is passed in by the jsml renderer as it traverses the structure. The function can also synchronously return a jsml structure on which the renderer will continue to operate. This allows you to intercept pointers to the elements as they are generated, which is particularly useful for asynchronous operations:</p>
<pre class="prettyprint">$(document.body).jsml({div: function(elem) {
  setTimeout(function() {
    elem.innerHTML = "1 second has passed";
  }, 1000);
  return "waiting...";
}});</pre>
<p>This is just one example of the benefits of leveraging pure javascript and its runtime environment (i.e., the event loop, closures, and lexical scoping) to generate both the markup and functionality of an application. Numerous frameworks (including those intended to run client-side) seek to separate logic from data in application development, creating templating languages with ungainly, ad-hoc syntaxes that re-implement the simplest features of a programming language. The result is slower, more complex and bloated applications with more global variables and an added learning curve. Rather than separate the two or try to insert logic into DOM markup, jsml represents DOM data naturally as a subset of the programming language, allowing entire applications to be written as a single javascript expression.</p>
<a href="http://github.com/kganser/jsml"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
